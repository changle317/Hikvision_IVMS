package main

import (
	"Exploit/common"
	"Exploit/exp/hikvision"
	"github.com/projectdiscovery/gologger"
	"os"
)

func hells() {

}

func main() {
	options := common.ParseOptions()
	if options.Url == "" && options.InputFile == "" {
		gologger.Print().Msgf("target is null\n")
		gologger.Print().Msgf("Exploit 是一个综合漏洞利用框架\nTARGET:\n   -u, -target string  input target url\n   -f, -file string    input target url file\n\nVUL:\n   -v, -vul string  select Hikvision, Hikvision_ivms_fastjson, Hikvision_ivms_upload1, Hikvision_ivms_upload2\n\nPORXY:\n   -l, -proxy string  http proxy to use (eg http://127.0.0.1:8080)\n\nWEBSHELL:\n   -w, -webshell string  input webshell")
		os.Exit(0)
	}

	if options.InputFile != "" {
		urls := common.Readfile(options.InputFile)
		for _, url := range urls {
			options.Url = url
			hikvision.Hikvision(options)
			//fmt.Println(url)
		}
	} else {
		hikvision.Hikvision(options)
	}
}
