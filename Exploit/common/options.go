package common

import (
	"github.com/projectdiscovery/goflags"
)

type Options struct {
	Url       string
	InputFile string
	Proxy     string
	Webshell  string
	Vul       string
}

//定义程序运行参数

func ParseOptions() *Options {
	options := &Options{}
	flagSet := goflags.NewFlagSet()
	flagSet.SetDescription(`Exploit 是一个综合漏洞利用框架`)

	flagSet.CreateGroup("target", "Target",
		flagSet.StringVarP(&options.Url, "target", "u", "", "input target url"),
		flagSet.StringVarP(&options.InputFile, "file", "f", "", "input target url file"),
	)
	flagSet.CreateGroup("vul", "Vul",
		flagSet.StringVarP(&options.Vul, "vul", "v", "", "select Hikvision, Hikvision_ivms_fastjson, Hikvision_ivms_upload1, Hikvision_ivms_upload2"),
	)

	flagSet.CreateGroup("proxy", "Porxy",
		flagSet.StringVarP(&options.Proxy, "proxy", "l", "", "http proxy to use (eg http://127.0.0.1:8080)"),
	)
	flagSet.CreateGroup("webshell", "Webshell",
		flagSet.StringVarP(&options.Webshell, "webshell", "w", "", "input webshell"),
	)
	_ = flagSet.Parse()
	return options
}
